session_name: layoutpreview
windows:
  - window_name: Frontend
    focus: true
    layout: main-vertical
    shell_command_before:
      - source ~/.nvm/nvm.sh
      - cd ~/code/aptoma/layoutpreview
    panes:
      - shell_command:
        - cd frontend

  - window_name: API
    layout: main-vertical
    shell_command_before:
      - source ~/.nvm/nvm.sh
      - cd ~/code/aptoma/layoutpreview
    panes:
      - shell_command:
        - cd api

  - window_name: Server Window
    layout: even-horizontal
    shell_command_before:
      - source ~/.nvm/nvm.sh
      - cd ~/code/aptoma/layoutpreview
    panes:
      - shell_command:
        - cd api
        - nvm use 
        - sleep 120
        - nodemon | pretty-hapi-log
      - shell_command:
        - cd frontend
        - tail -f app/log/app.log
      - shell_command:
        - cd frontend
        - vagrant up
        - npm run webpack:watch

  - window_name: LP Publish Proxy
    layout: main-vertical
    shell_command_before:
      - source ~/.nvm/nvm.sh
      - cd ~/code/aptoma/lp-publish-proxy
    panes:
      - shell_command:
        - nvm use
        - nodemon src/server.js


  - window_name: LayoutPreview Workers
    layout: main-vertical
    shell_command_before:
      - source ~/.nvm/nvm.sh
      - cd ~/code/aptoma/layoutpreview/
    panes:
      - shell_command:
        - cd layoutpreview-pages
        - nvm use
        - PORT=8980 node index.js
      - shell_command:
        - cd lp-screenshots
        - nvm use
        - PORT=8990 node index.js
